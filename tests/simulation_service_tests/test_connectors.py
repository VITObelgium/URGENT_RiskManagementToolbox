import sys
from typing import Any, Generator
from unittest.mock import MagicMock, Mock, patch

import numpy as np
import pytest

from services.simulation_service.core.connectors.common import (
    GridCell,
    WellManagementServiceResultSchema,
    WellName,
)
from services.simulation_service.core.connectors.open_darts import (
    OpenDartsConnector,
    _GlobalData,
    _StructDiscretizerProtocol,
    _StructReservoirProtocol,
    open_darts_input_configuration_injector,
)


@pytest.fixture
def mock_discretizer() -> _StructDiscretizerProtocol:
    mock: Mock = Mock(spec=_StructDiscretizerProtocol)
    mock.centroids_all_cells = np.asarray(
        [
            [25, 25, 25.0],
            [75, 25, 25.0],
            [125, 25, 25.0],
            [175, 25, 25.0],
            [225, 25, 25.0],
            [275, 25, 25.0],
            [325, 25, 25.0],
            [375, 25, 25.0],
            [425, 25, 25.0],
            [475, 25, 25.0],
            [25, 75, 25.0],
            [75, 75, 25.0],
            [125, 75, 25.0],
            [175, 75, 25.0],
            [225, 75, 25.0],
            [275, 75, 25.0],
            [325, 75, 25.0],
            [375, 75, 25.0],
            [425, 75, 25.0],
            [475, 75, 25.0],
            [25, 125, 25.0],
            [75, 125, 25.0],
            [125, 125, 25.0],
            [175, 125, 25.0],
            [225, 125, 25.0],
            [275, 125, 25.0],
            [325, 125, 25.0],
            [375, 125, 25.0],
            [425, 125, 25.0],
            [475, 125, 25.0],
            [25, 175, 25.0],
            [75, 175, 25.0],
            [125, 175, 25.0],
            [175, 175, 25.0],
            [225, 175, 25.0],
            [275, 175, 25.0],
            [325, 175, 25.0],
            [375, 175, 25.0],
            [425, 175, 25.0],
            [475, 175, 25.0],
            [25, 225, 25.0],
            [75, 225, 25.0],
            [125, 225, 25.0],
            [175, 225, 25.0],
            [225, 225, 25.0],
            [275, 225, 25.0],
            [325, 225, 25.0],
            [375, 225, 25.0],
            [425, 225, 25.0],
            [475, 225, 25.0],
            [25, 275, 25.0],
            [75, 275, 25.0],
            [125, 275, 25.0],
            [175, 275, 25.0],
            [225, 275, 25.0],
            [275, 275, 25.0],
            [325, 275, 25.0],
            [375, 275, 25.0],
            [425, 275, 25.0],
            [475, 275, 25.0],
            [25, 325, 25.0],
            [75, 325, 25.0],
            [125, 325, 25.0],
            [175, 325, 25.0],
            [225, 325, 25.0],
            [275, 325, 25.0],
            [325, 325, 25.0],
            [375, 325, 25.0],
            [425, 325, 25.0],
            [475, 325, 25.0],
            [25, 375, 25.0],
            [75, 375, 25.0],
            [125, 375, 25.0],
            [175, 375, 25.0],
            [225, 375, 25.0],
            [275, 375, 25.0],
            [325, 375, 25.0],
            [375, 375, 25.0],
            [425, 375, 25.0],
            [475, 375, 25.0],
            [25, 425, 25.0],
            [75, 425, 25.0],
            [125, 425, 25.0],
            [175, 425, 25.0],
            [225, 425, 25.0],
            [275, 425, 25.0],
            [325, 425, 25.0],
            [375, 425, 25.0],
            [425, 425, 25.0],
            [475, 425, 25.0],
            [25, 475, 25.0],
            [75, 475, 25.0],
            [125, 475, 25.0],
            [175, 475, 25.0],
            [225, 475, 25.0],
            [275, 475, 25.0],
            [325, 475, 25.0],
            [375, 475, 25.0],
            [425, 475, 25.0],
            [475, 475, 25.0],
            [25, 25, 75.0],
            [75, 25, 75.0],
            [125, 25, 75.0],
            [175, 25, 75.0],
            [225, 25, 75.0],
            [275, 25, 75.0],
            [325, 25, 75.0],
            [375, 25, 75.0],
            [425, 25, 75.0],
            [475, 25, 75.0],
            [25, 75, 75.0],
            [75, 75, 75.0],
            [125, 75, 75.0],
            [175, 75, 75.0],
            [225, 75, 75.0],
            [275, 75, 75.0],
            [325, 75, 75.0],
            [375, 75, 75.0],
            [425, 75, 75.0],
            [475, 75, 75.0],
            [25, 125, 75.0],
            [75, 125, 75.0],
            [125, 125, 75.0],
            [175, 125, 75.0],
            [225, 125, 75.0],
            [275, 125, 75.0],
            [325, 125, 75.0],
            [375, 125, 75.0],
            [425, 125, 75.0],
            [475, 125, 75.0],
            [25, 175, 75.0],
            [75, 175, 75.0],
            [125, 175, 75.0],
            [175, 175, 75.0],
            [225, 175, 75.0],
            [275, 175, 75.0],
            [325, 175, 75.0],
            [375, 175, 75.0],
            [425, 175, 75.0],
            [475, 175, 75.0],
            [25, 225, 75.0],
            [75, 225, 75.0],
            [125, 225, 75.0],
            [175, 225, 75.0],
            [225, 225, 75.0],
            [275, 225, 75.0],
            [325, 225, 75.0],
            [375, 225, 75.0],
            [425, 225, 75.0],
            [475, 225, 75.0],
            [25, 275, 75.0],
            [75, 275, 75.0],
            [125, 275, 75.0],
            [175, 275, 75.0],
            [225, 275, 75.0],
            [275, 275, 75.0],
            [325, 275, 75.0],
            [375, 275, 75.0],
            [425, 275, 75.0],
            [475, 275, 75.0],
            [25, 325, 75.0],
            [75, 325, 75.0],
            [125, 325, 75.0],
            [175, 325, 75.0],
            [225, 325, 75.0],
            [275, 325, 75.0],
            [325, 325, 75.0],
            [375, 325, 75.0],
            [425, 325, 75.0],
            [475, 325, 75.0],
            [25, 375, 75.0],
            [75, 375, 75.0],
            [125, 375, 75.0],
            [175, 375, 75.0],
            [225, 375, 75.0],
            [275, 375, 75.0],
            [325, 375, 75.0],
            [375, 375, 75.0],
            [425, 375, 75.0],
            [475, 375, 75.0],
            [25, 425, 75.0],
            [75, 425, 75.0],
            [125, 425, 75.0],
            [175, 425, 75.0],
            [225, 425, 75.0],
            [275, 425, 75.0],
            [325, 425, 75.0],
            [375, 425, 75.0],
            [425, 425, 75.0],
            [475, 425, 75.0],
            [25, 475, 75.0],
            [75, 475, 75.0],
            [125, 475, 75.0],
            [175, 475, 75.0],
            [225, 475, 75.0],
            [275, 475, 75.0],
            [325, 475, 75.0],
            [375, 475, 75.0],
            [425, 475, 75.0],
            [475, 475, 75.0],
            [25, 25, 125.0],
            [75, 25, 125.0],
            [125, 25, 125.0],
            [175, 25, 125.0],
            [225, 25, 125.0],
            [275, 25, 125.0],
            [325, 25, 125.0],
            [375, 25, 125.0],
            [425, 25, 125.0],
            [475, 25, 125.0],
            [25, 75, 125.0],
            [75, 75, 125.0],
            [125, 75, 125.0],
            [175, 75, 125.0],
            [225, 75, 125.0],
            [275, 75, 125.0],
            [325, 75, 125.0],
            [375, 75, 125.0],
            [425, 75, 125.0],
            [475, 75, 125.0],
            [25, 125, 125.0],
            [75, 125, 125.0],
            [125, 125, 125.0],
            [175, 125, 125.0],
            [225, 125, 125.0],
            [275, 125, 125.0],
            [325, 125, 125.0],
            [375, 125, 125.0],
            [425, 125, 125.0],
            [475, 125, 125.0],
            [25, 175, 125.0],
            [75, 175, 125.0],
            [125, 175, 125.0],
            [175, 175, 125.0],
            [225, 175, 125.0],
            [275, 175, 125.0],
            [325, 175, 125.0],
            [375, 175, 125.0],
            [425, 175, 125.0],
            [475, 175, 125.0],
            [25, 225, 125.0],
            [75, 225, 125.0],
            [125, 225, 125.0],
            [175, 225, 125.0],
            [225, 225, 125.0],
            [275, 225, 125.0],
            [325, 225, 125.0],
            [375, 225, 125.0],
            [425, 225, 125.0],
            [475, 225, 125.0],
            [25, 275, 125.0],
            [75, 275, 125.0],
            [125, 275, 125.0],
            [175, 275, 125.0],
            [225, 275, 125.0],
            [275, 275, 125.0],
            [325, 275, 125.0],
            [375, 275, 125.0],
            [425, 275, 125.0],
            [475, 275, 125.0],
            [25, 325, 125.0],
            [75, 325, 125.0],
            [125, 325, 125.0],
            [175, 325, 125.0],
            [225, 325, 125.0],
            [275, 325, 125.0],
            [325, 325, 125.0],
            [375, 325, 125.0],
            [425, 325, 125.0],
            [475, 325, 125.0],
            [25, 375, 125.0],
            [75, 375, 125.0],
            [125, 375, 125.0],
            [175, 375, 125.0],
            [225, 375, 125.0],
            [275, 375, 125.0],
            [325, 375, 125.0],
            [375, 375, 125.0],
            [425, 375, 125.0],
            [475, 375, 125.0],
            [25, 425, 125.0],
            [75, 425, 125.0],
            [125, 425, 125.0],
            [175, 425, 125.0],
            [225, 425, 125.0],
            [275, 425, 125.0],
            [325, 425, 125.0],
            [375, 425, 125.0],
            [425, 425, 125.0],
            [475, 425, 125.0],
            [25, 475, 125.0],
            [75, 475, 125.0],
            [125, 475, 125.0],
            [175, 475, 125.0],
            [225, 475, 125.0],
            [275, 475, 125.0],
            [325, 475, 125.0],
            [375, 475, 125.0],
            [425, 475, 125.0],
            [475, 475, 125.0],
            [25, 25, 175.0],
            [75, 25, 175.0],
            [125, 25, 175.0],
            [175, 25, 175.0],
            [225, 25, 175.0],
            [275, 25, 175.0],
            [325, 25, 175.0],
            [375, 25, 175.0],
            [425, 25, 175.0],
            [475, 25, 175.0],
            [25, 75, 175.0],
            [75, 75, 175.0],
            [125, 75, 175.0],
            [175, 75, 175.0],
            [225, 75, 175.0],
            [275, 75, 175.0],
            [325, 75, 175.0],
            [375, 75, 175.0],
            [425, 75, 175.0],
            [475, 75, 175.0],
            [25, 125, 175.0],
            [75, 125, 175.0],
            [125, 125, 175.0],
            [175, 125, 175.0],
            [225, 125, 175.0],
            [275, 125, 175.0],
            [325, 125, 175.0],
            [375, 125, 175.0],
            [425, 125, 175.0],
            [475, 125, 175.0],
            [25, 175, 175.0],
            [75, 175, 175.0],
            [125, 175, 175.0],
            [175, 175, 175.0],
            [225, 175, 175.0],
            [275, 175, 175.0],
            [325, 175, 175.0],
            [375, 175, 175.0],
            [425, 175, 175.0],
            [475, 175, 175.0],
            [25, 225, 175.0],
            [75, 225, 175.0],
            [125, 225, 175.0],
            [175, 225, 175.0],
            [225, 225, 175.0],
            [275, 225, 175.0],
            [325, 225, 175.0],
            [375, 225, 175.0],
            [425, 225, 175.0],
            [475, 225, 175.0],
            [25, 275, 175.0],
            [75, 275, 175.0],
            [125, 275, 175.0],
            [175, 275, 175.0],
            [225, 275, 175.0],
            [275, 275, 175.0],
            [325, 275, 175.0],
            [375, 275, 175.0],
            [425, 275, 175.0],
            [475, 275, 175.0],
            [25, 325, 175.0],
            [75, 325, 175.0],
            [125, 325, 175.0],
            [175, 325, 175.0],
            [225, 325, 175.0],
            [275, 325, 175.0],
            [325, 325, 175.0],
            [375, 325, 175.0],
            [425, 325, 175.0],
            [475, 325, 175.0],
            [25, 375, 175.0],
            [75, 375, 175.0],
            [125, 375, 175.0],
            [175, 375, 175.0],
            [225, 375, 175.0],
            [275, 375, 175.0],
            [325, 375, 175.0],
            [375, 375, 175.0],
            [425, 375, 175.0],
            [475, 375, 175.0],
            [25, 425, 175.0],
            [75, 425, 175.0],
            [125, 425, 175.0],
            [175, 425, 175.0],
            [225, 425, 175.0],
            [275, 425, 175.0],
            [325, 425, 175.0],
            [375, 425, 175.0],
            [425, 425, 175.0],
            [475, 425, 175.0],
            [25, 475, 175.0],
            [75, 475, 175.0],
            [125, 475, 175.0],
            [175, 475, 175.0],
            [225, 475, 175.0],
            [275, 475, 175.0],
            [325, 475, 175.0],
            [375, 475, 175.0],
            [425, 475, 175.0],
            [475, 475, 175.0],
            [25, 25, 225.0],
            [75, 25, 225.0],
            [125, 25, 225.0],
            [175, 25, 225.0],
            [225, 25, 225.0],
            [275, 25, 225.0],
            [325, 25, 225.0],
            [375, 25, 225.0],
            [425, 25, 225.0],
            [475, 25, 225.0],
            [25, 75, 225.0],
            [75, 75, 225.0],
            [125, 75, 225.0],
            [175, 75, 225.0],
            [225, 75, 225.0],
            [275, 75, 225.0],
            [325, 75, 225.0],
            [375, 75, 225.0],
            [425, 75, 225.0],
            [475, 75, 225.0],
            [25, 125, 225.0],
            [75, 125, 225.0],
            [125, 125, 225.0],
            [175, 125, 225.0],
            [225, 125, 225.0],
            [275, 125, 225.0],
            [325, 125, 225.0],
            [375, 125, 225.0],
            [425, 125, 225.0],
            [475, 125, 225.0],
            [25, 175, 225.0],
            [75, 175, 225.0],
            [125, 175, 225.0],
            [175, 175, 225.0],
            [225, 175, 225.0],
            [275, 175, 225.0],
            [325, 175, 225.0],
            [375, 175, 225.0],
            [425, 175, 225.0],
            [475, 175, 225.0],
            [25, 225, 225.0],
            [75, 225, 225.0],
            [125, 225, 225.0],
            [175, 225, 225.0],
            [225, 225, 225.0],
            [275, 225, 225.0],
            [325, 225, 225.0],
            [375, 225, 225.0],
            [425, 225, 225.0],
            [475, 225, 225.0],
            [25, 275, 225.0],
            [75, 275, 225.0],
            [125, 275, 225.0],
            [175, 275, 225.0],
            [225, 275, 225.0],
            [275, 275, 225.0],
            [325, 275, 225.0],
            [375, 275, 225.0],
            [425, 275, 225.0],
            [475, 275, 225.0],
            [25, 325, 225.0],
            [75, 325, 225.0],
            [125, 325, 225.0],
            [175, 325, 225.0],
            [225, 325, 225.0],
            [275, 325, 225.0],
            [325, 325, 225.0],
            [375, 325, 225.0],
            [425, 325, 225.0],
            [475, 325, 225.0],
            [25, 375, 225.0],
            [75, 375, 225.0],
            [125, 375, 225.0],
            [175, 375, 225.0],
            [225, 375, 225.0],
            [275, 375, 225.0],
            [325, 375, 225.0],
            [375, 375, 225.0],
            [425, 375, 225.0],
            [475, 375, 225.0],
            [25, 425, 225.0],
            [75, 425, 225.0],
            [125, 425, 225.0],
            [175, 425, 225.0],
            [225, 425, 225.0],
            [275, 425, 225.0],
            [325, 425, 225.0],
            [375, 425, 225.0],
            [425, 425, 225.0],
            [475, 425, 225.0],
            [25, 475, 225.0],
            [75, 475, 225.0],
            [125, 475, 225.0],
            [175, 475, 225.0],
            [225, 475, 225.0],
            [275, 475, 225.0],
            [325, 475, 225.0],
            [375, 475, 225.0],
            [425, 475, 225.0],
            [475, 475, 225.0],
            [25, 25, 275.0],
            [75, 25, 275.0],
            [125, 25, 275.0],
            [175, 25, 275.0],
            [225, 25, 275.0],
            [275, 25, 275.0],
            [325, 25, 275.0],
            [375, 25, 275.0],
            [425, 25, 275.0],
            [475, 25, 275.0],
            [25, 75, 275.0],
            [75, 75, 275.0],
            [125, 75, 275.0],
            [175, 75, 275.0],
            [225, 75, 275.0],
            [275, 75, 275.0],
            [325, 75, 275.0],
            [375, 75, 275.0],
            [425, 75, 275.0],
            [475, 75, 275.0],
            [25, 125, 275.0],
            [75, 125, 275.0],
            [125, 125, 275.0],
            [175, 125, 275.0],
            [225, 125, 275.0],
            [275, 125, 275.0],
            [325, 125, 275.0],
            [375, 125, 275.0],
            [425, 125, 275.0],
            [475, 125, 275.0],
            [25, 175, 275.0],
            [75, 175, 275.0],
            [125, 175, 275.0],
            [175, 175, 275.0],
            [225, 175, 275.0],
            [275, 175, 275.0],
            [325, 175, 275.0],
            [375, 175, 275.0],
            [425, 175, 275.0],
            [475, 175, 275.0],
            [25, 225, 275.0],
            [75, 225, 275.0],
            [125, 225, 275.0],
            [175, 225, 275.0],
            [225, 225, 275.0],
            [275, 225, 275.0],
            [325, 225, 275.0],
            [375, 225, 275.0],
            [425, 225, 275.0],
            [475, 225, 275.0],
            [25, 275, 275.0],
            [75, 275, 275.0],
            [125, 275, 275.0],
            [175, 275, 275.0],
            [225, 275, 275.0],
            [275, 275, 275.0],
            [325, 275, 275.0],
            [375, 275, 275.0],
            [425, 275, 275.0],
            [475, 275, 275.0],
            [25, 325, 275.0],
            [75, 325, 275.0],
            [125, 325, 275.0],
            [175, 325, 275.0],
            [225, 325, 275.0],
            [275, 325, 275.0],
            [325, 325, 275.0],
            [375, 325, 275.0],
            [425, 325, 275.0],
            [475, 325, 275.0],
            [25, 375, 275.0],
            [75, 375, 275.0],
            [125, 375, 275.0],
            [175, 375, 275.0],
            [225, 375, 275.0],
            [275, 375, 275.0],
            [325, 375, 275.0],
            [375, 375, 275.0],
            [425, 375, 275.0],
            [475, 375, 275.0],
            [25, 425, 275.0],
            [75, 425, 275.0],
            [125, 425, 275.0],
            [175, 425, 275.0],
            [225, 425, 275.0],
            [275, 425, 275.0],
            [325, 425, 275.0],
            [375, 425, 275.0],
            [425, 425, 275.0],
            [475, 425, 275.0],
            [25, 475, 275.0],
            [75, 475, 275.0],
            [125, 475, 275.0],
            [175, 475, 275.0],
            [225, 475, 275.0],
            [275, 475, 275.0],
            [325, 475, 275.0],
            [375, 475, 275.0],
            [425, 475, 275.0],
            [475, 475, 275.0],
            [25, 25, 325.0],
            [75, 25, 325.0],
            [125, 25, 325.0],
            [175, 25, 325.0],
            [225, 25, 325.0],
            [275, 25, 325.0],
            [325, 25, 325.0],
            [375, 25, 325.0],
            [425, 25, 325.0],
            [475, 25, 325.0],
            [25, 75, 325.0],
            [75, 75, 325.0],
            [125, 75, 325.0],
            [175, 75, 325.0],
            [225, 75, 325.0],
            [275, 75, 325.0],
            [325, 75, 325.0],
            [375, 75, 325.0],
            [425, 75, 325.0],
            [475, 75, 325.0],
            [25, 125, 325.0],
            [75, 125, 325.0],
            [125, 125, 325.0],
            [175, 125, 325.0],
            [225, 125, 325.0],
            [275, 125, 325.0],
            [325, 125, 325.0],
            [375, 125, 325.0],
            [425, 125, 325.0],
            [475, 125, 325.0],
            [25, 175, 325.0],
            [75, 175, 325.0],
            [125, 175, 325.0],
            [175, 175, 325.0],
            [225, 175, 325.0],
            [275, 175, 325.0],
            [325, 175, 325.0],
            [375, 175, 325.0],
            [425, 175, 325.0],
            [475, 175, 325.0],
            [25, 225, 325.0],
            [75, 225, 325.0],
            [125, 225, 325.0],
            [175, 225, 325.0],
            [225, 225, 325.0],
            [275, 225, 325.0],
            [325, 225, 325.0],
            [375, 225, 325.0],
            [425, 225, 325.0],
            [475, 225, 325.0],
            [25, 275, 325.0],
            [75, 275, 325.0],
            [125, 275, 325.0],
            [175, 275, 325.0],
            [225, 275, 325.0],
            [275, 275, 325.0],
            [325, 275, 325.0],
            [375, 275, 325.0],
            [425, 275, 325.0],
            [475, 275, 325.0],
            [25, 325, 325.0],
            [75, 325, 325.0],
            [125, 325, 325.0],
            [175, 325, 325.0],
            [225, 325, 325.0],
            [275, 325, 325.0],
            [325, 325, 325.0],
            [375, 325, 325.0],
            [425, 325, 325.0],
            [475, 325, 325.0],
            [25, 375, 325.0],
            [75, 375, 325.0],
            [125, 375, 325.0],
            [175, 375, 325.0],
            [225, 375, 325.0],
            [275, 375, 325.0],
            [325, 375, 325.0],
            [375, 375, 325.0],
            [425, 375, 325.0],
            [475, 375, 325.0],
            [25, 425, 325.0],
            [75, 425, 325.0],
            [125, 425, 325.0],
            [175, 425, 325.0],
            [225, 425, 325.0],
            [275, 425, 325.0],
            [325, 425, 325.0],
            [375, 425, 325.0],
            [425, 425, 325.0],
            [475, 425, 325.0],
            [25, 475, 325.0],
            [75, 475, 325.0],
            [125, 475, 325.0],
            [175, 475, 325.0],
            [225, 475, 325.0],
            [275, 475, 325.0],
            [325, 475, 325.0],
            [375, 475, 325.0],
            [425, 475, 325.0],
            [475, 475, 325.0],
            [25, 25, 375.0],
            [75, 25, 375.0],
            [125, 25, 375.0],
            [175, 25, 375.0],
            [225, 25, 375.0],
            [275, 25, 375.0],
            [325, 25, 375.0],
            [375, 25, 375.0],
            [425, 25, 375.0],
            [475, 25, 375.0],
            [25, 75, 375.0],
            [75, 75, 375.0],
            [125, 75, 375.0],
            [175, 75, 375.0],
            [225, 75, 375.0],
            [275, 75, 375.0],
            [325, 75, 375.0],
            [375, 75, 375.0],
            [425, 75, 375.0],
            [475, 75, 375.0],
            [25, 125, 375.0],
            [75, 125, 375.0],
            [125, 125, 375.0],
            [175, 125, 375.0],
            [225, 125, 375.0],
            [275, 125, 375.0],
            [325, 125, 375.0],
            [375, 125, 375.0],
            [425, 125, 375.0],
            [475, 125, 375.0],
            [25, 175, 375.0],
            [75, 175, 375.0],
            [125, 175, 375.0],
            [175, 175, 375.0],
            [225, 175, 375.0],
            [275, 175, 375.0],
            [325, 175, 375.0],
            [375, 175, 375.0],
            [425, 175, 375.0],
            [475, 175, 375.0],
            [25, 225, 375.0],
            [75, 225, 375.0],
            [125, 225, 375.0],
            [175, 225, 375.0],
            [225, 225, 375.0],
            [275, 225, 375.0],
            [325, 225, 375.0],
            [375, 225, 375.0],
            [425, 225, 375.0],
            [475, 225, 375.0],
            [25, 275, 375.0],
            [75, 275, 375.0],
            [125, 275, 375.0],
            [175, 275, 375.0],
            [225, 275, 375.0],
            [275, 275, 375.0],
            [325, 275, 375.0],
            [375, 275, 375.0],
            [425, 275, 375.0],
            [475, 275, 375.0],
            [25, 325, 375.0],
            [75, 325, 375.0],
            [125, 325, 375.0],
            [175, 325, 375.0],
            [225, 325, 375.0],
            [275, 325, 375.0],
            [325, 325, 375.0],
            [375, 325, 375.0],
            [425, 325, 375.0],
            [475, 325, 375.0],
            [25, 375, 375.0],
            [75, 375, 375.0],
            [125, 375, 375.0],
            [175, 375, 375.0],
            [225, 375, 375.0],
            [275, 375, 375.0],
            [325, 375, 375.0],
            [375, 375, 375.0],
            [425, 375, 375.0],
            [475, 375, 375.0],
            [25, 425, 375.0],
            [75, 425, 375.0],
            [125, 425, 375.0],
            [175, 425, 375.0],
            [225, 425, 375.0],
            [275, 425, 375.0],
            [325, 425, 375.0],
            [375, 425, 375.0],
            [425, 425, 375.0],
            [475, 425, 375.0],
            [25, 475, 375.0],
            [75, 475, 375.0],
            [125, 475, 375.0],
            [175, 475, 375.0],
            [225, 475, 375.0],
            [275, 475, 375.0],
            [325, 475, 375.0],
            [375, 475, 375.0],
            [425, 475, 375.0],
            [475, 475, 375.0],
            [25, 25, 425.0],
            [75, 25, 425.0],
            [125, 25, 425.0],
            [175, 25, 425.0],
            [225, 25, 425.0],
            [275, 25, 425.0],
            [325, 25, 425.0],
            [375, 25, 425.0],
            [425, 25, 425.0],
            [475, 25, 425.0],
            [25, 75, 425.0],
            [75, 75, 425.0],
            [125, 75, 425.0],
            [175, 75, 425.0],
            [225, 75, 425.0],
            [275, 75, 425.0],
            [325, 75, 425.0],
            [375, 75, 425.0],
            [425, 75, 425.0],
            [475, 75, 425.0],
            [25, 125, 425.0],
            [75, 125, 425.0],
            [125, 125, 425.0],
            [175, 125, 425.0],
            [225, 125, 425.0],
            [275, 125, 425.0],
            [325, 125, 425.0],
            [375, 125, 425.0],
            [425, 125, 425.0],
            [475, 125, 425.0],
            [25, 175, 425.0],
            [75, 175, 425.0],
            [125, 175, 425.0],
            [175, 175, 425.0],
            [225, 175, 425.0],
            [275, 175, 425.0],
            [325, 175, 425.0],
            [375, 175, 425.0],
            [425, 175, 425.0],
            [475, 175, 425.0],
            [25, 225, 425.0],
            [75, 225, 425.0],
            [125, 225, 425.0],
            [175, 225, 425.0],
            [225, 225, 425.0],
            [275, 225, 425.0],
            [325, 225, 425.0],
            [375, 225, 425.0],
            [425, 225, 425.0],
            [475, 225, 425.0],
            [25, 275, 425.0],
            [75, 275, 425.0],
            [125, 275, 425.0],
            [175, 275, 425.0],
            [225, 275, 425.0],
            [275, 275, 425.0],
            [325, 275, 425.0],
            [375, 275, 425.0],
            [425, 275, 425.0],
            [475, 275, 425.0],
            [25, 325, 425.0],
            [75, 325, 425.0],
            [125, 325, 425.0],
            [175, 325, 425.0],
            [225, 325, 425.0],
            [275, 325, 425.0],
            [325, 325, 425.0],
            [375, 325, 425.0],
            [425, 325, 425.0],
            [475, 325, 425.0],
            [25, 375, 425.0],
            [75, 375, 425.0],
            [125, 375, 425.0],
            [175, 375, 425.0],
            [225, 375, 425.0],
            [275, 375, 425.0],
            [325, 375, 425.0],
            [375, 375, 425.0],
            [425, 375, 425.0],
            [475, 375, 425.0],
            [25, 425, 425.0],
            [75, 425, 425.0],
            [125, 425, 425.0],
            [175, 425, 425.0],
            [225, 425, 425.0],
            [275, 425, 425.0],
            [325, 425, 425.0],
            [375, 425, 425.0],
            [425, 425, 425.0],
            [475, 425, 425.0],
            [25, 475, 425.0],
            [75, 475, 425.0],
            [125, 475, 425.0],
            [175, 475, 425.0],
            [225, 475, 425.0],
            [275, 475, 425.0],
            [325, 475, 425.0],
            [375, 475, 425.0],
            [425, 475, 425.0],
            [475, 475, 425.0],
            [25, 25, 475.0],
            [75, 25, 475.0],
            [125, 25, 475.0],
            [175, 25, 475.0],
            [225, 25, 475.0],
            [275, 25, 475.0],
            [325, 25, 475.0],
            [375, 25, 475.0],
            [425, 25, 475.0],
            [475, 25, 475.0],
            [25, 75, 475.0],
            [75, 75, 475.0],
            [125, 75, 475.0],
            [175, 75, 475.0],
            [225, 75, 475.0],
            [275, 75, 475.0],
            [325, 75, 475.0],
            [375, 75, 475.0],
            [425, 75, 475.0],
            [475, 75, 475.0],
            [25, 125, 475.0],
            [75, 125, 475.0],
            [125, 125, 475.0],
            [175, 125, 475.0],
            [225, 125, 475.0],
            [275, 125, 475.0],
            [325, 125, 475.0],
            [375, 125, 475.0],
            [425, 125, 475.0],
            [475, 125, 475.0],
            [25, 175, 475.0],
            [75, 175, 475.0],
            [125, 175, 475.0],
            [175, 175, 475.0],
            [225, 175, 475.0],
            [275, 175, 475.0],
            [325, 175, 475.0],
            [375, 175, 475.0],
            [425, 175, 475.0],
            [475, 175, 475.0],
            [25, 225, 475.0],
            [75, 225, 475.0],
            [125, 225, 475.0],
            [175, 225, 475.0],
            [225, 225, 475.0],
            [275, 225, 475.0],
            [325, 225, 475.0],
            [375, 225, 475.0],
            [425, 225, 475.0],
            [475, 225, 475.0],
            [25, 275, 475.0],
            [75, 275, 475.0],
            [125, 275, 475.0],
            [175, 275, 475.0],
            [225, 275, 475.0],
            [275, 275, 475.0],
            [325, 275, 475.0],
            [375, 275, 475.0],
            [425, 275, 475.0],
            [475, 275, 475.0],
            [25, 325, 475.0],
            [75, 325, 475.0],
            [125, 325, 475.0],
            [175, 325, 475.0],
            [225, 325, 475.0],
            [275, 325, 475.0],
            [325, 325, 475.0],
            [375, 325, 475.0],
            [425, 325, 475.0],
            [475, 325, 475.0],
            [25, 375, 475.0],
            [75, 375, 475.0],
            [125, 375, 475.0],
            [175, 375, 475.0],
            [225, 375, 475.0],
            [275, 375, 475.0],
            [325, 375, 475.0],
            [375, 375, 475.0],
            [425, 375, 475.0],
            [475, 375, 475.0],
            [25, 425, 475.0],
            [75, 425, 475.0],
            [125, 425, 475.0],
            [175, 425, 475.0],
            [225, 425, 475.0],
            [275, 425, 475.0],
            [325, 425, 475.0],
            [375, 425, 475.0],
            [425, 425, 475.0],
            [475, 425, 475.0],
            [25, 475, 475.0],
            [75, 475, 475.0],
            [125, 475, 475.0],
            [175, 475, 475.0],
            [225, 475, 475.0],
            [275, 475, 475.0],
            [325, 475, 475.0],
            [375, 475, 475.0],
            [425, 475, 475.0],
            [475, 475, 475.0],
        ]
    )
    return mock


@pytest.fixture
def global_data_mock() -> _GlobalData:
    return {
        "dx": np.asarray(
            [
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
            ]
        ),
        "dy": np.asarray(
            [
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
            ]
        ),
        "dz": np.asarray(
            [
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
                [
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                    [50, 50, 50, 50, 50, 50, 50, 50, 50, 50.0],
                ],
            ]
        ),
    }


@pytest.fixture
def mock_struct_reservoir(
    mock_discretizer: _StructDiscretizerProtocol, global_data_mock: _GlobalData
) -> _StructReservoirProtocol:
    class MockStructReservoir:
        nx: int = 10
        ny: int = 10
        nz: int = 10
        discretizer: _StructDiscretizerProtocol = mock_discretizer
        global_data: _GlobalData = global_data_mock

    return MockStructReservoir()


@pytest.mark.parametrize(
    "wells_result, expected_output",
    [
        (
            {
                "wells": [
                    {
                        "name": "Test IWell",
                        "trajectory": [
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 10.0],
                            [0.0, 0.0, 50.0],
                            [0.0, 0.0, 60.0],
                            [0.0, 0.0, 70.0],
                            [0.0, 0.0, 80.0],
                            [0.0, 0.0, 100.0],
                        ],
                        "completion": {
                            "perforations": [
                                {
                                    "range": [10.0, 60.0],
                                    "points": [
                                        [0.0, 0.0, 10.0],
                                        [0.0, 0.0, 50.0],
                                        [0.0, 0.0, 60.0],
                                    ],
                                },
                                {
                                    "range": [70.0, 80.0],
                                    "points": [[0.0, 0.0, 70.0], [0.0, 0.0, 80.0]],
                                },
                            ]
                        },
                    }
                ]
            },
            {"Test IWell": ((1, 1, 1), (1, 1, 2))},
        )
    ],
)
def test_get_well_connection_cells(
    mock_struct_reservoir: Mock,
    wells_result: WellManagementServiceResultSchema,
    expected_output: dict[WellName, tuple[GridCell, ...]],
) -> None:
    actual_result = OpenDartsConnector.get_well_connection_cells(
        wells_result, mock_struct_reservoir
    )
    assert actual_result == expected_output


@pytest.fixture
def mock_subprocess_run() -> Generator[Mock, None, None]:
    with patch("subprocess.run") as mock_run:
        yield mock_run


def test_run_success(mock_subprocess_run: Mock) -> None:
    mock_process = MagicMock()
    mock_process.returncode = 0
    mock_process.stdout = (
        "Building connection list...\n"
        "OpenDartsConnector: Type:heat, Value:2312.12\n"
        "OpenDartsConnector: Type:heat, Value:[1.23, 4.56, 7.89]\n"
        "# 1 	T = 0.0001	DT = 0.0001	NI = 2	LI=2\n"
        "# 2 	T = 0.0003	DT = 0.0002	NI = 1	LI=1\n"
        "# 3 	T = 0.0007	DT = 0.0004	NI = 1	LI=1\n"
        "# 4 	T = 0.0015	DT = 0.0008	NI = 1	LI=1\n"
    )
    mock_subprocess_run.return_value = mock_process

    results = OpenDartsConnector.run("test_config")

    assert results == {"heat": [2312.12, [1.23, 4.56, 7.89]]}


def test_run_success_with_single_broadcasted_value(mock_subprocess_run: Mock) -> None:
    mock_process = MagicMock()
    mock_process.returncode = 0
    mock_process.stdout = (
        "Building connection list...\n"
        "OpenDartsConnector: Type:heat, Value:2312.12\n"
        "# 1 	T = 0.0001	DT = 0.0001	NI = 2	LI=2\n"
        "# 2 	T = 0.0003	DT = 0.0002	NI = 1	LI=1\n"
        "# 3 	T = 0.0007	DT = 0.0004	NI = 1	LI=1\n"
        "# 4 	T = 0.0015	DT = 0.0008	NI = 1	LI=1\n"
    )
    mock_subprocess_run.return_value = mock_process

    results = OpenDartsConnector.run("test_config")

    assert results == {"heat": 2312.12}


def test_run_failure(mock_subprocess_run: Mock) -> None:
    mock_process = MagicMock()
    mock_process.returncode = 1
    mock_process.stdout = ""
    mock_subprocess_run.return_value = mock_process

    with pytest.raises(RuntimeError):
        _ = OpenDartsConnector.run("test_config")


@open_darts_input_configuration_injector
def main(configuration_content: dict[str, Any]) -> None:
    print(f"Received configuration: {configuration_content}")


# Pytest test cases
def test_decorator_with_valid_json(monkeypatch, capsys):  # type: ignore
    # Mock sys.argv to simulate command-line arguments
    valid_json = '{"key": "value", "number": 42}'
    monkeypatch.setattr(sys, "argv", ["main.py", valid_json])

    # Call the decorated function
    main()

    # Capture printed output and verify it
    captured = capsys.readouterr()
    assert "Received configuration: {'key': 'value', 'number': 42}" in captured.out


def test_decorator_with_invalid_json(monkeypatch, capsys):  # type: ignore
    # Mock sys.argv to simulate command-line arguments with invalid JSON
    invalid_json = '{"key": "value", "number": 42'
    monkeypatch.setattr(sys, "argv", ["main.py", invalid_json])

    # Mock sys.exit to prevent the test from stopping
    with patch("sys.exit") as mock_exit:
        main()
        mock_exit.assert_called_once_with(1)

    # Capture printed output and verify the error message
    captured = capsys.readouterr()
    assert "Invalid JSON input." in captured.out


def test_decorator_with_missing_argument(monkeypatch, capsys):  # type: ignore
    # Mock sys.argv to simulate no arguments provided
    monkeypatch.setattr(sys, "argv", ["main.py"])

    # Mock sys.exit to raise an exception
    with patch("sys.exit", side_effect=SystemExit) as mock_exit:
        with pytest.raises(SystemExit):
            main()
        mock_exit.assert_called_once_with(1)

    # Capture printed output and verify the usage message
    captured = capsys.readouterr()
    assert "Usage: python main.py 'configuration.json (TBD)'" in captured.out
